<p align="center">
<img src="./client/public/vibe.svg" width="300px">
</p>

# 1. About
:building_construction: The repository is under construction, not every part of it is finalized or optimized for performance in it`s current state.

[Vibe](https://vibe-salty.vercel.app) is a web application created for personal use and for demonstration purposes, utilising the latest Front-End technologies in web development.<br/>
The application is designed to control a unique device with focus on creating animations portrayed by an LED matrix using an interactive interface. See one of the [inspirations](https://youtu.be/64X5sJJ4YKM?si=_vRgQX4lwe8lhrCd&t=170) that started the project.

# 2. Vibe as a web application </br>
Through this app, a user is able to create, edit, play, and manage different animations using an interactive interface. These operations are associated with a user account, all data is stored inside a database so progress can be saved.
The created animations can be used with any device that are capable to drive an LED strip, mainly in a matrix grid configuration, via downloading the raw data or accesing it from the database. The data conversion must be made by the user so it accommodates the specific LED driver library, like [FastLED](https://fastled.io).

## 2.1. Framework
The app is based on the [Next.js 14 App Router](https://nextjs.org/docs/app) framework, deployed and managed by the [Vercel](https://vercel.com/) platform.

## 2.3 User Interface
-  The UI and it`s interactivity made with **React 18** library.
-  The components are mostly based on [MUI v5](https://mui.com/) in combination with custom components following the Material Design.
-  The tables are created with [Material React Table](https://www.material-react-table.com/). Examples: [animations](https://github.com/extra-salty/vibe/blob/557c268a64681dd247c71f9f299b2e73e8300e16/client/src/components/home/Animations/Animations.tsx), [playlist](https://github.com/extra-salty/vibe/blob/557c268a64681dd247c71f9f299b2e73e8300e16/client/src/components/home/Playlist/Playlist.tsx)
-  The draggable and droppable components are made with [dnd kit](https://dndkit.com/) for React.
## 2.4 State Management
- ### Local State:
  Locally scoped state which is accessible by only a specific part of the UI, mostly by a parent component and it`s children.
  - synchronous logic are handled by React built in state hooks.
  - asynchronous logic with loading and error state are handled by [SWR](https://swr.vercel.app/):
    - actions that are called on render are made with useSWR hook, [example](https://github.com/extra-salty/vibe/blob/79a31f631e4535d92cbbf508a9d610552a30f521/client/src/components/user/ConfirmResult/ConfirmResult.tsx).
    - actions that are called on user interaction are made with useSWRMutation hook, [example](https://github.com/extra-salty/vibe/blob/79a31f631e4535d92cbbf508a9d610552a30f521/client/src/components/user/forms/RegisterForm/RegisterForm.tsx).
- ### [Global State](https://github.com/extra-salty/vibe/tree/557c268a64681dd247c71f9f299b2e73e8300e16/client/src/libs/redux):
  Globally scoped state which is accessed by multiple components and updated by various user interaction throughout the **home** route is handled by [Redux Toolkit](https://redux-toolkit.js.org/) and by React context providers where state persistence is not required.
  It is separated into multiple [slices](https://github.com/extra-salty/vibe/tree/79a31f631e4535d92cbbf508a9d610552a30f521/client/src/libs/redux/features) for easier maintanence. These are combined as [reducers](https://github.com/extra-salty/vibe/blob/79a31f631e4535d92cbbf508a9d610552a30f521/client/src/libs/redux/reducers.ts) and passed to the [store](https://github.com/extra-salty/vibe/blob/79a31f631e4535d92cbbf508a9d610552a30f521/client/src/libs/redux/store.ts) when created together with the middlewares.
  - synchronous logic is handled with the reducer functions generated by the individual slices.
  - asynchronous logic with loading and error state are handled by [Async Thunk](https://redux-toolkit.js.org/usage/usage-guide#async-requests-with-createasyncthunk) action creators:
    - these are integrated into the slices where it manages mostly the requests made to update or acquire some data from the database.
    - a reference to the custom database API is passed down as an [extra argument](https://github.com/extra-salty/vibe/blob/main/client/src/libs/redux/store.ts#L12) to the Thunk middleware, resulting in maintanable dataflow between the database and the global state.
    - the reason behind not using RTK Query is that most of the requests are made with the database own SDK wrapped inside a custom API, integrating it makes no benefits.
- ### State Persistence:
  The [entire](https://github.com/extra-salty/vibe/blob/main/client/src/libs/redux/reducers.ts#L36) global state is persisted handled by [Redux-Persist](https://www.npmjs.com/package/redux-persist). This way, the state which represents the user progress made in the app can be recovered if the page refreshes or reopens when visited again.
  - The state is stored within the browser [local storage](https://github.com/extra-salty/vibe/blob/79a31f631e4535d92cbbf508a9d610552a30f521/client/src/libs/redux/storage.ts#L22), but Next requires a [dummy storage](https://github.com/extra-salty/vibe/blob/main/client/src/libs/redux/storage.ts#L8-L20) to be set up on the server side for proper functioning.
  - The persisted state is cleared from the storage if the user signs out so it wouldn`t interfere if a different user signs it.
- ### State Synchronization (in progress)
  The app can be used across multiple browser tabs enabling multiple monitor set up handled by [Redux-State-Sync](https://www.npmjs.com/package/redux-state-sync).
 

## 2.9 Database


# 3. Vibe as a hardware
- The 'brain' of the device is an ESP32 microcontroller, it`s role includes controlling the several other modules of the device and establishing a connection with the web app through WIFI, using HTTP and WebSocket protocol.
- The device CAD is constructed with Onshape and 3D printed using a Creality Ender 3 V2 printer.
The 3D representation can be seen here: [Onshape](https://cad.onshape.com/documents/4604ff47bb3fefabcff9ad3e/w/4bb2ac810232bce12ef560a2/e/d9e19047e28542bd3fb74dc6)

## Inspired by:
- https://www.youtube.com/watch?v=64X5sJJ4YKM&ab_channel=Cine-Lights
- https://www.youtube.com/watch?v=_3DFLblpgec&ab_channel=ExcitingCreations
- https://www.youtube.com/watch?v=PfRFWxaPOLY&ab_channel=3DMakerNoob
